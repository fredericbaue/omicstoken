# OmicsToken ‚Äì Unified Engineering + UX + CTO Priority Task List
# Version: 2025-12-02
# This file consolidates MVP-Critical, Infrastructure, UX, and Productization tasks
# into a single prioritized roadmap for Codex in VS Code.

======================================================================
## üî• 0. Absolute Rule (Non-Negotiable)
NEVER break the pipeline:

Upload ‚Üí Parse ‚Üí Store Features ‚Üí Embed ‚Üí Store Embeddings ‚Üí Rebuild Index ‚Üí
Search ‚Üí Compare ‚Üí Summarize ‚Üí Export.

All code changes must preserve this end-to-end flow.
======================================================================


======================================================================
## üö® P0 ‚Äî CRITICAL FOUNDATION (Required for investors, labs, and scaling)
======================================================================

[x] P0.1 MIGRATE DATABASE TO POSTGRESQL
     - Replace SQLite (immuno.sqlite + users.db) with PostgreSQL.
     - Update DB connections, models, migrations, and thread safety.
     - Ensure FAISS rebuild still works with new DB structure.
     [x] Introduce DB_BACKEND config and configurable users DB path (first prep step).
     - ModelVersion table + model_version_id added to peptide_embeddings; SQLite remains default.

[x] P0.2 CENTRALIZED LOGGING & TRACING
     - Implement request/response logging middleware.
     - Add correlation IDs and redact sensitive fields.
     - Support pluggable log sinks (stdout for now; Sentry later).

[x] P0.3 LEGAL & COMPLIANCE FOUNDATION
     - Add ToS, Privacy Policy, and Data Processing Policy placeholder files.
     - Ensure UI links can reference these pages.
     - Do NOT implement full compliance backend yet.
     - Placeholder Terms/Privacy pages added with footer links across user pages.

[ ] P0.4 CLOUD FILE STORAGE (S3/Blob)
     - Store raw uploads in cloud object storage instead of local disk.
     - Integrate signed URLs for secure download.
     - Maintain compatibility with existing parsing pipeline.

[x] P0.5 ADVANCED BACKGROUND JOB ENGINE
     - Replace FastAPI threadpool with Celery/Redis Queue.
     - Embed ‚Üí Index rebuild ‚Üí Summaries must be queued jobs.
     - Ensure full reproducibility and crash recovery.
     - Celery worker now queues embed -> rebuild -> summary; API callers unchanged.


======================================================================
## üíé P1 ‚Äî UX/UI PHASE 2.1 (High-impact demo & scientist polish)
# These tasks dramatically improve user experience without changing the backend.
======================================================================

### CRITICAL UX (Clutter Reduction & Primary Flow Efficiency)

[x] UX.C1 REFACTOR RUN LIST ACTIONS (static/runs.html)
     - Consolidate Delete, Fingerprint, Re-embed into a single dropdown.
     - Keep only ‚ÄúDashboard‚Äù, ‚ÄúSummary‚Äù, ‚ÄúSearch‚Äù as primary actions.

[x] UX.C2 SIMPLIFY STATUS LABELS (static/runs.html)
     - Replace computeStatus logic with clearer statuses:
       "Ready", "Processing", "Waiting for Embedding".

### HIGH VALUE UX (Flow & Friction Removal)

[x] UX.H1 DRAG-AND-DROP UPLOAD (static/upload.html)
     - Replace file input with a branded drag-and-drop upload zone.
     - Add hover/focus visual feedback.

[x] UX.H2 CROSS-CONTEXTUAL SEARCH LINKING
     - Make peptides clickable everywhere:
       Dashboard, Fingerprint, Compare.
     - Clicking automatically loads search.html with run_id + feature_id selected.

[x] UX.H3 POST-UPLOAD FUNNEL
     - After upload ‚Üí show success banner ‚Üí link directly to Runs List.
     - Remove friction returning to /runs.html.

### MEDIUM UX (Trust & Polish)

[ ] UX.M1 TRANSPARENT LLM SUMMARY (static/summary.html)
     - Add "Powered by Gemini 2.5 Flash".
     - Include collapsible <details> showing AI context input.

[x] UX.M2 ACTIONABLE CREDITS DISPLAY (static/runs.html)
     - Clicking Credits badge opens a tooltip/modal with:
       "Credits consumed per action. Subscription options coming soon."

[ ] UX.M3 DASHBOARD CLEANUP (static/dashboard.html)
     - Remove or grey out unimplemented controls ("Predict Binding").
     - Prevent user confusion about non-ready features.


======================================================================
## üíº P2 ‚Äî MONETIZATION & PRODUCTIZATION
======================================================================

[ ] P2.1 STRIPE PAYMENT INTEGRATION
     - Add subscription flow + webhook handler.
     - Tie credits to purchases.

[ ] P2.2 CREDITS PRICING MODEL
     - Define cost per:
       Upload, Embedding batch, Similarity search, LLM summary.

[ ] P2.3 USAGE ANALYTICS DASHBOARD
     - Track per-run and per-user usage.
     - Show credit consumption and activity heatmap.


======================================================================
## üß† P3 ‚Äî ADVANCED SCIENTIFIC FEATURES (Future)
======================================================================

[ ] P3.1 STATISTICAL TESTS (t-tests, ANOVA)
     - Optional downstream analysis modules.

[ ] P3.2 GO / PATHWAY ENRICHMENT
     - Optional biological interpretation module.

[ ] P3.3 DIFFERENTIAL PEPTIDE ANALYSIS
     - Later version of the comparison engine.


======================================================================
## üåê P4 ‚Äî PLATFORM EXPANSION
======================================================================

[ ] P4.1 MIGRATE UI TO REACT/NEXT.JS
     - Replace static/ with full modern SPA/SSR architecture.

[ ] P4.2 MULTI-OMICS TOKENIZATION
     - Extend embeddings to metabolomics, transcriptomics, proteogenomics.


======================================================================
## üß≠ FINISHED TASKS (DON‚ÄôT MODIFY)
======================================================================

[x] 1.1 Hardened Export Auth
[x] 1.2 Hardened FAISS Rebuild
[x] 1.3 Stabilized ESM-2 Embedding Engine
[x] 1.4 Background Task & DB Safety
[x] 1.5 Endpoint Robustness & Ownership Rules
[x] 2.1 Legacy Table Isolation
[x] 2.2 Embedder Interface Introduced
[x] 2.3 Centralized Config & Embedder Factory
[x] 2.4 Config Defaults Documented
[x] 2.5 Centralized Logging (Partially Complete)
[x] 2.6 Add request/response logging middleware with redaction and correlation IDs
      <!-- Structural: refined logging & diagnostics for later -->
[x] 4.1 Scientist Run Dashboard MVP
[x] 4.2 Fingerprint Visualization UI
[x] A. Tiny UX polish pass (encoding/copy fixes)
[x] 4.4 Peptide Explanation UI
[x] 5.1 Multi-Run Export Bundle
[x] 5.2 Automated Insight Report
[x] 5.3 API Tokens for Lab Integrations
